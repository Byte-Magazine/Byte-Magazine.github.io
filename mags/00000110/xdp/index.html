<!doctype html>
<html lang="fa" dir="rtl" class="docs-wrapper plugin-docs plugin-id-mags docs-version-current docs-doc-page docs-doc-id-00000110/xdp/index" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">پروتکل XDP: یک قدم قبل از کرنل | نشریه‌ی علمی فرهنگی بایت</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://byte-mag.ir/img/social-card.png"><meta data-rh="true" name="twitter:image" content="https://byte-mag.ir/img/social-card.png"><meta data-rh="true" property="og:url" content="https://byte-mag.ir/mags/00000110/xdp/"><meta data-rh="true" property="og:locale" content="fa"><meta data-rh="true" name="docusaurus_locale" content="fa"><meta data-rh="true" name="docsearch:language" content="fa"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-mags-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-mags-current"><meta data-rh="true" property="og:title" content="پروتکل XDP: یک قدم قبل از کرنل | نشریه‌ی علمی فرهنگی بایت"><meta data-rh="true" name="description" content="تا به حال به این فکر کرده‌اید که غول‌های فناوری مانند کلادفلر چگونه حملات گستردهٔ DDoS را در نطفه خفه می‌کنند"><meta data-rh="true" property="og:description" content="تا به حال به این فکر کرده‌اید که غول‌های فناوری مانند کلادفلر چگونه حملات گستردهٔ DDoS را در نطفه خفه می‌کنند"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://byte-mag.ir/mags/00000110/xdp/"><link data-rh="true" rel="alternate" href="https://byte-mag.ir/mags/00000110/xdp/" hreflang="fa"><link data-rh="true" rel="alternate" href="https://byte-mag.ir/mags/00000110/xdp/" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"00000110 (5 نوشته)","item":"https://byte-mag.ir/mags/00000110"},{"@type":"ListItem","position":2,"name":"پروتکل XDP: یک قدم قبل از کرنل","item":"https://byte-mag.ir/mags/00000110/xdp/"}]}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="نشریه‌ی علمی فرهنگی بایت RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="نشریه‌ی علمی فرهنگی بایت Atom Feed">





<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.48caaf13.css">
<script src="/assets/js/runtime~main.af42dd77.js" defer="defer"></script>
<script src="/assets/js/main.f5d1b238.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="dark";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/logo.svg"><link rel="preload" as="image" href="/img/authors/yazdanBahadori.png"><div role="region" aria-label="پرش به مطلب اصلی"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">پرش به مطلب اصلی</a></div><nav aria-label="صفحه اصلی" class="theme-layout-navbar navbar navbar--fixed-top navbar--dark"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="باز و بست منو" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">نشریه‌ی علمی فرهنگی بایت</b></a><a class="navbar__item navbar__link" href="/mags/intro">آرشیو نشریه</a><a href="#" class="navbar__item navbar__link">وبلاگ (بزودی)</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/staff">اعضای مرکزی</a><a class="navbar__item navbar__link" href="/authors">نویسندگان</a><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_eExm"><div class="docsWrapper_hBAB"><button aria-label="بازگشت به بالا" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="نوار کناری مستندات" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mags/intro">شماره‌های منتشر شده</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/mags/00000001">00000001 (8 نوشته)</a><button aria-label="باز کردن دسته بندی در نوار کناری &#x27;00000001 (8 نوشته)&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/mags/00000010">00000010 (17 نوشته)</a><button aria-label="باز کردن دسته بندی در نوار کناری &#x27;00000010 (17 نوشته)&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/mags/00000011">00000011 (8 نوشته)</a><button aria-label="باز کردن دسته بندی در نوار کناری &#x27;00000011 (8 نوشته)&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/mags/00000100">00000100 (7 نوشته)</a><button aria-label="باز کردن دسته بندی در نوار کناری &#x27;00000100 (7 نوشته)&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/mags/00000101">00000101 (7 نوشته)</a><button aria-label="باز کردن دسته بندی در نوار کناری &#x27;00000101 (7 نوشته)&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/mags/00000110">00000110 (5 نوشته)</a><button aria-label="بستن دسته بندی در نوار کناری &#x27;00000110 (5 نوشته)&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/mags/00000110/sarmaghale/">سرمقاله - نقطه سر خط</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/mags/00000110/xdp/">پروتکل XDP: یک قدم قبل از کرنل</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/mags/00000110/neurons-and-silicon-meet/">هنگامی که نورون و سیلیکون به هم می‌رسند!</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/mags/00000110/federated-learning/">وقتی داده‌ها مهاجرت نمی‌کنند: روایت یادگیری فدرال</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/mags/00000110/IIot/">کارخانه‌ای با مغز دیجیتال</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="نشانگر صفحات"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="صفحه اصلی" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/mags/00000110"><span>00000110 (5 نوشته)</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">پروتکل XDP: یک قدم قبل از کرنل</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">مطالب این صفحه</button></div><div class="theme-doc-markdown markdown"><div class="docAuthors_AnFi margin-bottom--md"><div class="docAuthor_y7l7"><img src="/img/authors/yazdanBahadori.png" alt="یزدان  بهادری‌منش" class="docAuthorImg_vlJe"><div><div class="docAuthorName_aSh4">یزدان  بهادری‌منش</div><div class="docAuthorTitle_Yp5_">کارشناسی ۱۴۰۰ مهندسی کامپیوتر خوارزمی</div><div class="docAuthorSocials_M3ba"><a href="https://www.linkedin.com/in/yazdanbahadori/" target="_blank" rel="noopener noreferrer" class="docAuthorSocialLink_trj9"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 448 512" height="20" width="20" xmlns="http://www.w3.org/2000/svg"><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"></path></svg></a><a href="https://github.com/yazdanbhd" target="_blank" rel="noopener noreferrer" class="docAuthorSocialLink_trj9"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 496 512" height="20" width="20" xmlns="http://www.w3.org/2000/svg"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg></a></div></div></div></div><header><h1>پروتکل XDP: یک قدم قبل از کرنل</h1></header>
<p>تا به حال به این فکر کرده‌اید که غول‌های فناوری مانند
<span class="wrapper_CZBo"><span class="text_qqsc"><span><strong>کلادفلر</strong></span></span><span class="tooltip_lI6R undefined">Cloudflare</span></span>
چگونه حملات گستردهٔ DDoS را در نطفه خفه می‌کنند یا شرکت‌هایی مانند گوگل و متا چطور میلیاردها درخواست کاربر را بدون لحظه‌ای وقفه مدیریت می‌کنند؟ پاسخ، اغلب در اعماق کرنل لینوکس (منظور از کرنل لینوکس،‌ کرنل گنو/لینوکس است) و در دل فناوری قدرتمندی به نام
<span class="wrapper_CZBo"><span class="text_qqsc"><span><strong>مسیر دادهٔ سریع</strong></span></span><span class="tooltip_lI6R undefined">eXpress Data Path (XDP)</span></span>
نهفته است. XDP یک پروتکل مهم در دنیای شبکه‌های مدرن است که با عملکرد فوق‌العاده بالا، به برنامه‌ها اجازه می‌دهد بسته‌های شبکه را در اولین نقطهٔ ممکن، یعنی درست در درایور کارت شبکه، مدیریت کنند. این یعنی دستیابی به سرعتی نزدیک به سخت‌افزار، بدون نیاز به دور زدن کامل کرنل.</p>
<p>XDP با استفاده از eBPF، به توسعه‌دهندگان این قدرت را می‌دهد که منطق سفارشی خود را برای مقابله با حملات،
<span class="wrapper_CZBo"><span class="text_qqsc"><span><strong>متعادل‌سازی بار</strong></span></span><span class="tooltip_lI6R undefined">Load Balancing</span></span>
و فایروال، با کمترین سربار ممکن پیاده‌سازی کنند. در این نوشته ابتدا می‌بینیم که مشکل استک شبکهٔ سنتی لینوکس چیست، سپس تا حدودی با معماری هوشمندانهٔ XDP آشنا می‌شویم و در نهایت، نگاهی به کاربرد واقعی آن در پروژه‌ای مانند Cilium می‌اندازیم که از XDP برای ساخت نسل جدیدی از متعادل‌کننده‌های بار خود استفاده می‌کند.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="مشکل-کجاست">مشکل کجاست؟<a href="#مشکل-کجاست" class="hash-link" aria-label="لینک مستقیم به مشکل کجاست؟" title="لینک مستقیم به مشکل کجاست؟">​</a></h2>
<p>برای درک ارزش XDP، ابتدا باید با مسیر یک بسته در استک شبکهٔ سنتی لینوکس آشنا شویم. وقتی یک بسته به
<span class="wrapper_CZBo"><span class="text_qqsc"><span><strong>اینترفیس کارت شبکه</strong></span></span><span class="tooltip_lI6R undefined">Network Interface Card (NIC)</span></span>
می‌رسد، کرنل برای مدیریت آن یک داده‌ساختار به نام <code>sk_buff</code> (بافر سوکت) ایجاد می‌کند. این ساختار، مثل یک کوله‌پشتی، اطلاعات زیادی را در خود جای می‌دهد و همین اطلاعات زیاد، باعث سنگین و پرهزینه شدن آن شده‌است.</p>
<p>در حجم ترافیک بالا، مثلاً در مقیاس میلیون‌ها بسته در ثانیه، فرآیند تخصیص و مدیریت حافظه برای این «کوله‌پشتی‌ها» به یک
<span class="wrapper_CZBo"><span class="text_qqsc"><span><strong>گلوگاه</strong></span></span><span class="tooltip_lI6R undefined">bottleneck</span></span>
جدی تبدیل می‌شود و عملکرد درست را مختل می‌کند.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="یک-راهحل-رادیکال">یک راه‌حل رادیکال<a href="#یک-راهحل-رادیکال" class="hash-link" aria-label="لینک مستقیم به یک راه‌حل رادیکال" title="لینک مستقیم به یک راه‌حل رادیکال">​</a></h2>
<p>نقطهٔ قوت XDP دقیقاً همین‌جاست. این پروتکل، یک
<span class="wrapper_CZBo"><span class="text_qqsc"><span><strong>قلاب</strong></span></span><span class="tooltip_lI6R undefined">Hook</span></span>
استراتژیک در درایور کارت شبکه، یعنی قبل از آن‌که کرنل بخواهد ساختار پرهزینهٔ <code>sk_buff</code> را ایجاد کند، قرار می‌دهد. عملکرد XDP صرفاً سرعت بالاتر نیست، بلکه برای حذف کارهای غیرضروری است.</p>
<p>برای هر بسته‌ای که یک برنامهٔ XDP تصمیم به
<span class="wrapper_CZBo"><span class="text_qqsc"><span><strong>رها کردن</strong></span></span><span class="tooltip_lI6R undefined">Drop</span></span>
یا
<span class="wrapper_CZBo"><span class="text_qqsc"><span><strong>هدایت مجدد</strong></span></span><span class="tooltip_lI6R undefined">Redirect</span></span>
آن می‌گیرد، کرنل از تمام هزینهٔ مربوط به ایجاد و مدیریت یک بافر سوکت خلاص می‌شود. به همین دلیل است که XDP می‌تواند ده‌ها میلیون بسته در ثانیه را روی یک کرنل پردازنده مدیریت کند.</p>
<p>این یک جهش عملکردی عظیم در مقایسه با فیلتر کردن بسته‌ها در لایه‌های بالاتر مانند <code>iptables</code> است؛ به‌ویژه در سناریوهایی مانند حملات DDoS که سرنوشت اکثر بسته‌ها، دور ریخته‌شدن است.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="از-آزمایش-تا-نهایت-سرعت">از آزمایش تا نهایت سرعت<a href="#از-آزمایش-تا-نهایت-سرعت" class="hash-link" aria-label="لینک مستقیم به از آزمایش تا نهایت سرعت" title="لینک مستقیم به از آزمایش تا نهایت سرعت">​</a></h2>
<p>یک برنامهٔ XDP می‌تواند در سه حالت مختلف اجرا شود که هر کدام تعادلی بین عملکرد و سازگاری با سخت‌افزار ارائه می‌دهند:</p>
<ul>
<li><span class="wrapper_CZBo"><span class="text_qqsc"><span><strong>XDP بومی</strong></span></span><span class="tooltip_lI6R undefined">Native XDP</span></span>: سریع‌ترین حالت که در آن برنامه مستقیماً در درایور کارت شبکه بارگذاری می‌شود و نیازمند پشتیبانی درایور است.</li>
<li><span class="wrapper_CZBo"><span class="text_qqsc"><span><strong>XDP عمومی</strong></span></span><span class="tooltip_lI6R undefined">Generic XDP</span></span>: یک حالت نرم‌افزاری جایگزین که روی هر سخت‌افزاری کار می‌کند. این حالت برای توسعه و آزمایش ایده‌آل است، زیرا به توسعه‌دهندگان اجازه می‌دهد منطق خود را حتی روی لپ‌تاپ‌شان بنویسند و بعداً روی سرورهای قدرتمند مستقر کنند.</li>
<li><span class="wrapper_CZBo"><span class="text_qqsc"><span><strong>XDP تخلیه‌شده</strong></span></span><span class="tooltip_lI6R undefined">Offloaded XDP</span></span>: نهایت عملکرد، جایی که برنامهٔ eBPF مستقیماً روی سخت‌افزار کارت شبکه اجرا می‌شود و بسته‌ها را بدون درگیر کردن پردازندهٔ اصلی پردازش می‌کند. این حالت نیازمند کارت‌های شبکهٔ تخصصی است.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="چگونه-کار-میکند">چگونه کار می‌کند؟<a href="#چگونه-کار-میکند" class="hash-link" aria-label="لینک مستقیم به چگونه کار می‌کند؟" title="لینک مستقیم به چگونه کار می‌کند؟">​</a></h2>
<p>در عمل، برنامه‌های XDP کدهایی هستند که با زیرمجموعه‌ای از زبان C نوشته شده و به بایت‌کد eBPF کامپایل می‌شوند. این کدها در یک محیط ایزوله و امن در کرنل به نام ماشین مجازی eBPF اجرا می‌شوند.</p>
<p>تا این‌جا چندین بار به این‌که XDP از eBPF استفاده می‌کند اشاره شد و سؤال این‌جاست که eBPF چیست؟</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="ebpf-مغز-متفکر-عملیات">eBPF: مغز متفکر عملیات<a href="#ebpf-مغز-متفکر-عملیات" class="hash-link" aria-label="لینک مستقیم به eBPF: مغز متفکر عملیات" title="لینک مستقیم به eBPF: مغز متفکر عملیات">​</a></h2>
<p>eBPF یک تکنولوژی قدرتمند در لینوکس است که اجازه می‌دهد برنامه‌های کوچکی را داخل کرنل اجرا کنیم، بدون نیاز به این‌که کدهای کرنل را تغییر بدهیم. قبل از بارگذاری هر برنامه،
<span class="wrapper_CZBo"><span class="text_qqsc"><span><strong>تأییدکننده</strong></span></span><span class="tooltip_lI6R undefined">Verifier</span></span>
کد را به دقت بررسی و تست می‌کند تا مطمئن شود که کد نوشته‌شده، هیچ کار خطرناکی مانند حلقه‌های بی‌نهایت یا دسترسی غیرمجاز به حافظه انجام نمی‌دهد.</p>
<p>این سازوکار ایمنی، انقلابی در برنامه‌نویسی کرنل است؛ زیرا به ما اجازه می‌دهد بدون خطر نوشتن ماژول‌های پیچیده، کدهای سفارشی را در قلب سیستم‌عامل و کرنل اجرا کنیم.</p>
<p>دنیای کاربردهای eBPF بسیار گسترده است و هر روز هم وسعت بیشتری پیدا می‌کند. پس بیایید چند مورد از کاربردهای مهم eBPF به‌جز پروتکل XDP را بررسی کنیم:</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="مشاهده-و-ردیابی">مشاهده و ردیابی<a href="#مشاهده-و-ردیابی" class="hash-link" aria-label="لینک مستقیم به مشاهده و ردیابی" title="لینک مستقیم به مشاهده و ردیابی">​</a></h3>
<p>با eBPF می‌توانیم نقاط حساس کرنل و یوزر اسپیس را بی‌درنگ اندازه‌گیری و دنبال کنیم: تأخیر سیستمی، فراخوانی توابع، مقدار I/O، تعداد پردازه‌ها و غیره.</p>
<p>با استفاده از ابزارهایی مثل <code>bpftrace</code> (ابزاری برای  اسکریپت‌های tracing با eBPF)  داده‌ها را جمع‌آوری می‌کنیم و امکان ساخت
<span class="wrapper_CZBo"><span class="text_qqsc"><span><strong>متریک‌ها</strong></span></span><span class="tooltip_lI6R undefined">metrics</span></span>
و پارامترهای دقیق دیگری را می‌دهد، بدون این‌که برنامه را متوقف کنیم عملکرد را به‌طور قابل‌توجهی خراب کنیم. همچنین خروجی‌ها را می‌توان به ابزارهای مانیتورینگ و tracing مثل Prometheus فرستاد تا تحلیل و ارتباط بین سرویس‌ها امکان‌پذیر شود.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="مدیریت-و-کنترل-منابع">مدیریت و کنترل منابع<a href="#مدیریت-و-کنترل-منابع" class="hash-link" aria-label="لینک مستقیم به مدیریت و کنترل منابع" title="لینک مستقیم به مدیریت و کنترل منابع">​</a></h3>
<p>با استفاده از eBPF می‌توان مصرف CPU، حافظه، I/O و شبکه را دقیق‌تر از قبل اندازه‌گیری و کنترل کرد. مثلاً برای اجرای سیاست‌های
<span class="wrapper_CZBo"><span class="text_qqsc"><span><strong>کیفیت سرویس (QoS)</strong></span></span><span class="tooltip_lI6R undefined">Quality of Service (QoS)</span></span>
یا تضمین
<span class="wrapper_CZBo"><span class="text_qqsc"><span><strong>اهداف سطح سرویس (SLO)</strong></span></span><span class="tooltip_lI6R undefined">Service Level Objective (SLO)</span></span>
می‌توانیم ترافیک یا کارهای یک گروه پردازه را اولویت‌بندی و محدود کنیم.
ترکیب eBPF با cgroups و کنترلرهای دیگر به شما اجازه می‌دهد رفتار زمان‌بندی و مصرف منابع را بر اساس قواعد پویا تغییر بدهید.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="بالانسرها-و-مسیریابی-هوشمند">بالانسرها و مسیریابی هوشمند<a href="#بالانسرها-و-مسیریابی-هوشمند" class="hash-link" aria-label="لینک مستقیم به بالانسرها و مسیریابی هوشمند" title="لینک مستقیم به بالانسرها و مسیریابی هوشمند">​</a></h3>
<p>با eBPF این امکان را داریم که ترافیک شبکه را بر اساس اطلاعات سطح اپلیکیشن یا متریک‌های runtime هدایت کنیم؛ این یعنی لودبالانسرهای هوشمند و مسیریابی آگاه از سرویس که از وضعیت واقعی هر نود آگاه هستند و تصمیمات بهینه‌تری می‌گیرند.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="پروژهٔ-متنباز-cilium-قدرتگرفته-از-xdp">پروژهٔ متن‌باز Cilium، قدرت‌گرفته از XDP<a href="#پروژهٔ-متنباز-cilium-قدرتگرفته-از-xdp" class="hash-link" aria-label="لینک مستقیم به پروژهٔ متن‌باز Cilium، قدرت‌گرفته از XDP" title="لینک مستقیم به پروژهٔ متن‌باز Cilium، قدرت‌گرفته از XDP">​</a></h2>
<p>Cilium یک پروژهٔ شبکهٔ ابری پیشرو برای Kubernetes است که از eBPF برای شبکه، امنیت و مشاهده‌پذیری استفاده می‌کند. Cilium به‌طور هوشمندانه از XDP برای شتاب‌دهی ترافیک ورودی و خروجی از کلاستر (ترافیک شمال-جنوب) در <span class="wrapper_CZBo"><span class="text_qqsc"><span><strong>متعادل‌کنندهٔ بار</strong></span></span><span class="tooltip_lI6R undefined">Load Balancing / Service-aware Routing</span></span> خود بهره می‌برد.</p>
<p>این معماری به Cilium اجازه می‌دهد تا قابلیت‌هایی مانند
<span class="wrapper_CZBo"><span class="text_qqsc"><span><strong>بازگشت مستقیم سرور</strong></span></span><span class="tooltip_lI6R undefined">Dynamic Source Routing (DSR)</span></span>
را پیاده‌سازی کند. در این حالت، سرور پشتیبان پاسخ را مستقیماً برای کاربر ارسال می‌کند و متعادل‌کننده، بار را در مسیر بازگشت دور می‌زند که باعث کاهش تأخیر و حفظ آدرس IP اصلی کاربر می‌شود.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="داستان-موفقیت-seznamcz">داستان موفقیت Seznam.cz<a href="#داستان-موفقیت-seznamcz" class="hash-link" aria-label="لینک مستقیم به داستان موفقیت Seznam.cz" title="لینک مستقیم به داستان موفقیت Seznam.cz">​</a></h2>
<p>شرکت فناوری Seznam، یکی از شرکت‌های بزرگ جمهوری چک، متعادل‌کنندهٔ بار قدیمی خود (مبتنی بر IPVS) را با راه‌حل L4LB مستقل Cilium که از XDP استفاده می‌کند، جایگزین کرد.</p>
<p>راه‌حل قبلی آن‌ها در ترافیک سنگین (تا ۲۰ میلیون اتصال همزمان) هسته‌های پردازنده را به مرز ظرفیت خود می‌رساند. در نتیجه تصمیم گرفتند به Cilium مهاجرت کنند.</p>
<p>آن‌ها شاهد کاهش ۷۲ برابری در مصرف پردازنده بودند! مصرف پردازنده از ۳۶ هستهٔ کامل به تنها نصف یک هسته کاهش یافت، در حالی‌که همان حجم ترافیک را مدیریت می‌کردند.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="آیندهای-که-میتواند-بسازد">آینده‌ای که می‌تواند بسازد<a href="#آیندهای-که-میتواند-بسازد" class="hash-link" aria-label="لینک مستقیم به آینده‌ای که می‌تواند بسازد" title="لینک مستقیم به آینده‌ای که می‌تواند بسازد">​</a></h2>
<p>XDP فقط یک ابزار بهینه‌سازی نیست؛ بلکه یک بلوک ساختمانی بنیادی برای نسل بعدی زیرساخت‌های شبکه است. با ترکیب عملکرد خام سخت‌افزار و انعطاف‌پذیری نرم‌افزار، XDP به توسعه‌دهندگان اجازه می‌دهد راه‌حل‌های نوآورانه‌ای برای چالش‌های بزرگ دنیای شبکه، از امنیت و متعادل‌سازی بار گرفته تا مشاهده‌پذیری، خلق کنند.</p>
<p>این فناوری که در سکوت، در قلب لینوکس کار می‌کند، بدون شک سنگ‌‌بنای بسیاری از زیرساخت‌های نرم‌افزارمحور در آینده خواهد بود.</p>
<p>باید در نظر داشته باشیم همچنان اکثر شرکت‌های بزرگ و کوچک از این تکنولوژی استفاده نمی‌کنند و در آینده احتمالاً زیاد قرار است اسم XDP را بشنویم!</p>
<p>در واقع XDP هنوز در مراحل پذیرش اولیه‌ قرار دارد و خیلی از شرکت‌ها تازه سراغ آن رفته‌اند، ولی روند استفاده از آن رو به رشد است.</p>
<p>با بیشتر شدن پشتیبانی ابزارها و تجربهٔ جامعهٔ کاربری، این پروتکل می‌تواند به یکی از اجزای عادی و جدی زیرساخت‌های شبکه در سال‌های آینده تبدیل شود.</p>
<div style="text-align:center"><p><img decoding="async" loading="lazy" src="/assets/images/img1-c253bdd62671d9a28d08c13d41266ebe.svg" width="337" height="674" class="img_ev3q"></p></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-tags-row"><div class="col"><b>برچسب‌ها:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/mags/tags/linux">Linux</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/mags/tags/network">Network</a></li></ul></div></div><br><div style="border-top:2px solid #ccc;padding-top:20px;margin-top:10px" class="giscus-container"></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="صفحات مستندات"><a class="pagination-nav__link pagination-nav__link--prev" href="/mags/00000110/sarmaghale/"><div class="pagination-nav__sublabel">قبلی</div><div class="pagination-nav__label">سرمقاله - نقطه سر خط</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/mags/00000110/neurons-and-silicon-meet/"><div class="pagination-nav__sublabel">بعدی</div><div class="pagination-nav__label">هنگامی که نورون و سیلیکون به هم می‌رسند!</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#مشکل-کجاست" class="table-of-contents__link toc-highlight">مشکل کجاست؟</a></li><li><a href="#یک-راهحل-رادیکال" class="table-of-contents__link toc-highlight">یک راه‌حل رادیکال</a></li><li><a href="#از-آزمایش-تا-نهایت-سرعت" class="table-of-contents__link toc-highlight">از آزمایش تا نهایت سرعت</a></li><li><a href="#چگونه-کار-میکند" class="table-of-contents__link toc-highlight">چگونه کار می‌کند؟</a></li><li><a href="#ebpf-مغز-متفکر-عملیات" class="table-of-contents__link toc-highlight">eBPF: مغز متفکر عملیات</a><ul><li><a href="#مشاهده-و-ردیابی" class="table-of-contents__link toc-highlight">مشاهده و ردیابی</a></li><li><a href="#مدیریت-و-کنترل-منابع" class="table-of-contents__link toc-highlight">مدیریت و کنترل منابع</a></li><li><a href="#بالانسرها-و-مسیریابی-هوشمند" class="table-of-contents__link toc-highlight">بالانسرها و مسیریابی هوشمند</a></li></ul></li><li><a href="#پروژهٔ-متنباز-cilium-قدرتگرفته-از-xdp" class="table-of-contents__link toc-highlight">پروژهٔ متن‌باز Cilium، قدرت‌گرفته از XDP</a></li><li><a href="#داستان-موفقیت-seznamcz" class="table-of-contents__link toc-highlight">داستان موفقیت Seznam.cz</a></li><li><a href="#آیندهای-که-میتواند-بسازد" class="table-of-contents__link toc-highlight">آینده‌ای که می‌تواند بسازد</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer_d1NW" role="contentinfo"><div class="topRow_Kw87"><div><h3 class="title_R8t4">ارتباط با ما</h3><div class="contactLinks_Ri0r"><a class="link_scak" href="mailto:bytepublication@gmail.com"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path fill="none" d="M0 0h24v24H0z"></path><path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4-8 5-8-5V6l8 5 8-5v2z"></path></svg><span>bytepublication@gmail.com</span></a><a class="link_scak" href="https://docs.google.com/forms/d/e/1FAIpQLSfjtbcWu6cLSklvKAXpqJ0P0tm4yis5t9VN_C0PsCptgpDAxQ/viewform" target="_blank" rel="noopener noreferrer" style="flex-direction:row-reverse"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 384 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M336 64h-80c0-35.3-28.7-64-64-64s-64 28.7-64 64H48C21.5 64 0 85.5 0 112v352c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48V112c0-26.5-21.5-48-48-48zM192 40c13.3 0 24 10.7 24 24s-10.7 24-24 24-24-10.7-24-24 10.7-24 24-24zm144 418c0 3.3-2.7 6-6 6H54c-3.3 0-6-2.7-6-6V118c0-3.3 2.7-6 6-6h42v36c0 6.6 5.4 12 12 12h168c6.6 0 12-5.4 12-12v-36h42c3.3 0 6 2.7 6 6z"></path></svg><span>عضویت در نشریه</span></a></div></div><div><h3 class="title_R8t4">ما را دنبال کنید</h3><div class="socialLinks_R943"><a class="link_scak" href="https://t.me/byte_mag" target="_blank" rel="noopener noreferrer"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 496 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M248 8C111 8 0 119 0 256s111 248 248 248 248-111 248-248S385 8 248 8zm121.8 169.9l-40.7 191.8c-3 13.6-11.1 16.9-22.4 10.5l-62-45.7-29.9 28.8c-3.3 3.3-6.1 6.1-12.5 6.1l4.4-63.1 114.9-103.8c5-4.4-1.1-6.9-7.7-2.5l-142 89.4-61.2-19.1c-13.3-4.2-13.6-13.3 2.8-19.7l239.1-92.2c11.1-4 20.8 2.7 17.2 19.5z"></path></svg><span>Telegram</span></a><a class="link_scak" href="https://github.com/Byte-Magazine" target="_blank" rel="noopener noreferrer"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 496 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg><span>GitHub</span></a><a class="link_scak" href="https://www.linkedin.com/company/byte-publication/" target="_blank" rel="noopener noreferrer"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 448 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"></path></svg><span>LinkedIn</span></a><a class="link_scak" href="https://twitter.com/BytePublication" target="_blank" rel="noopener noreferrer"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"></path></svg><span>Twitter</span></a></div></div></div><div class="divider_NBTE"></div><div class="copy_kvc_">© نشریه‌ی علمی فرهنگی بایت - دانشکده مهندسی کامپیوتر - دانشگاه صنعتی شریف</div></footer></div>
</body>
</html>